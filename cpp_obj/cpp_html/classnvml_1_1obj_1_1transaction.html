<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>NVML C++ bindings: nvml::obj::transaction Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">NVML C++ bindings
   &#160;<span id="projectnumber">0.1 experimental</span>
   </div>
   <div id="projectbrief">This is the C++ bindings documentation for NVML&#39;s libpmemobj.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><b>nvml</b></li><li class="navelem"><b>obj</b></li><li class="navelem"><a class="el" href="classnvml_1_1obj_1_1transaction.html">transaction</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="classnvml_1_1obj_1_1transaction-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">nvml::obj::transaction Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>C++ transaction handler class.  
 <a href="classnvml_1_1obj_1_1transaction.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="transaction_8hpp_source.html">transaction.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction_1_1automatic.html">automatic</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">C++ automatic scope transaction class.  <a href="classnvml_1_1obj_1_1transaction_1_1automatic.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction_1_1manual.html">manual</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">C++ manual scope transaction class.  <a href="classnvml_1_1obj_1_1transaction_1_1manual.html#details">More...</a><br/></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a2bcb66ca21771c10a0cb85c4831709ab"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#a2bcb66ca21771c10a0cb85c4831709ab">~transaction</a> () noexcept=delete</td></tr>
<tr class="memdesc:a2bcb66ca21771c10a0cb85c4831709ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Default destructor.  <a href="#a2bcb66ca21771c10a0cb85c4831709ab">More...</a><br/></td></tr>
<tr class="separator:a2bcb66ca21771c10a0cb85c4831709ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ad931939218d921dd4f0395771d07d80f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#ad931939218d921dd4f0395771d07d80f">abort</a> (int err)</td></tr>
<tr class="memdesc:ad931939218d921dd4f0395771d07d80f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manually abort the current transaction.  <a href="#ad931939218d921dd4f0395771d07d80f">More...</a><br/></td></tr>
<tr class="separator:ad931939218d921dd4f0395771d07d80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f036c0fa7bc23f927202943c13952a6"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#a8f036c0fa7bc23f927202943c13952a6">commit</a> ()</td></tr>
<tr class="memdesc:a8f036c0fa7bc23f927202943c13952a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Manually commit a transaction.  <a href="#a8f036c0fa7bc23f927202943c13952a6">More...</a><br/></td></tr>
<tr class="separator:a8f036c0fa7bc23f927202943c13952a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a751a3ce8102a977ea6ab3532fa1bf202"><td class="memTemplParams" colspan="2">template&lt;typename... Locks&gt; </td></tr>
<tr class="memitem:a751a3ce8102a977ea6ab3532fa1bf202"><td class="memTemplItemLeft" align="right" valign="top">static void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#a751a3ce8102a977ea6ab3532fa1bf202">exec_tx</a> (<a class="el" href="classnvml_1_1obj_1_1pool__base.html">pool_base</a> &amp;<a class="el" href="classnvml_1_1obj_1_1pool.html">pool</a>, std::function&lt; void()&gt; tx, Locks &amp;...locks)</td></tr>
<tr class="memdesc:a751a3ce8102a977ea6ab3532fa1bf202"><td class="mdescLeft">&#160;</td><td class="mdescRight">Execute a closure-like transaction and lock <code>locks</code>.  <a href="#a751a3ce8102a977ea6ab3532fa1bf202">More...</a><br/></td></tr>
<tr class="separator:a751a3ce8102a977ea6ab3532fa1bf202"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:ada712c3c249cdb5e15cd35a5224cfd69"><td class="memTemplParams" colspan="2">template&lt;typename L , typename... Locks&gt; </td></tr>
<tr class="memitem:ada712c3c249cdb5e15cd35a5224cfd69"><td class="memTemplItemLeft" align="right" valign="top">static int&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#ada712c3c249cdb5e15cd35a5224cfd69">add_lock</a> (L &amp;lock, Locks &amp;...locks) noexcept</td></tr>
<tr class="memdesc:ada712c3c249cdb5e15cd35a5224cfd69"><td class="mdescLeft">&#160;</td><td class="mdescRight">Recursively add locks to the active transaction.  <a href="#ada712c3c249cdb5e15cd35a5224cfd69">More...</a><br/></td></tr>
<tr class="separator:ada712c3c249cdb5e15cd35a5224cfd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe39b2a0898f0dc5350c05df67ec45af"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abe39b2a0898f0dc5350c05df67ec45af"></a>
static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classnvml_1_1obj_1_1transaction.html#abe39b2a0898f0dc5350c05df67ec45af">add_lock</a> () noexcept</td></tr>
<tr class="memdesc:abe39b2a0898f0dc5350c05df67ec45af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method ending the recursive algorithm. <br/></td></tr>
<tr class="separator:abe39b2a0898f0dc5350c05df67ec45af"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>C++ transaction handler class. </p>
<p>This class is the pmemobj transaction handler. Scoped transactions are handled through two internal classes: <a class="el" href="classnvml_1_1obj_1_1transaction_1_1manual.html">manual</a> and <a class="el" href="classnvml_1_1obj_1_1transaction_1_1automatic.html">automatic</a>.</p>
<ul>
<li><a class="el" href="classnvml_1_1obj_1_1transaction_1_1manual.html">manual</a> transactions need to be committed manually, otherwise they will be aborted on object destruction.<br/>
</li>
<li><a class="el" href="classnvml_1_1obj_1_1transaction_1_1automatic.html">automatic</a> transactions are only available in C++17. They handle transaction commit/abort automatically. This class also exposes a closure-like transaction API. </li>
</ul>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a2bcb66ca21771c10a0cb85c4831709ab"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">nvml::obj::transaction::~transaction </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">delete</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Default destructor. </p>
<p>End pmemobj transaction. If the transaction has not been committed before object destruction, an abort will be issued. </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="ad931939218d921dd4f0395771d07d80f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvml::obj::transaction::abort </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>err</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Manually abort the current transaction. </p>
<p>If called within an inner transaction. the outer transactions will also be aborted.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">err</td><td>the error to be reported as the reason of the abort.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classnvml_1_1transaction__error.html" title="Custom transaction error class. ">transaction_error</a></td><td>if the transaction is in an invalid state </td></tr>
    <tr><td class="paramname"><a class="el" href="classnvml_1_1manual__tx__abort.html" title="Custom transaction error class. ">manual_tx_abort</a></td><td>this exception is thrown to signify a transaction abort. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ada712c3c249cdb5e15cd35a5224cfd69"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename L , typename... Locks&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int nvml::obj::transaction::add_lock </td>
          <td>(</td>
          <td class="paramtype">L &amp;&#160;</td>
          <td class="paramname"><em>lock</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Locks &amp;...&#160;</td>
          <td class="paramname"><em>locks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span><span class="mlabel">private</span><span class="mlabel">noexcept</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Recursively add locks to the active transaction. </p>
<p>The locks are taken in the provided order.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">lock</td><td>the lock to add. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">locks</td><td>the rest of the locks to be added to the active transaction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error number if adding any of the locks failed, 0 otherwise </dd></dl>

</div>
</div>
<a class="anchor" id="a8f036c0fa7bc23f927202943c13952a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvml::obj::transaction::commit </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Manually commit a transaction. </p>
<p>It is the sole responsibility of the caller, that after the call to <a class="el" href="classnvml_1_1obj_1_1transaction.html#a8f036c0fa7bc23f927202943c13952a6" title="Manually commit a transaction. ">transaction::commit()</a> no other operations are done within the transaction.</p>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classnvml_1_1transaction__error.html" title="Custom transaction error class. ">transaction_error</a></td><td>on any errors with ending the transaction. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="a751a3ce8102a977ea6ab3532fa1bf202"></a>
<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;typename... Locks&gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void nvml::obj::transaction::exec_tx </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classnvml_1_1obj_1_1pool__base.html">pool_base</a> &amp;&#160;</td>
          <td class="paramname"><em>pool</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::function&lt; void()&gt;&#160;</td>
          <td class="paramname"><em>tx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Locks &amp;...&#160;</td>
          <td class="paramname"><em>locks</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Execute a closure-like transaction and lock <code>locks</code>. </p>
<p>The locks have to be persistent memory resident locks. An attempt to lock the locks will be made. If any of the specified locks is already locked, the method will block. The locks are held until the end of the transaction. The transaction does not have to be committed manually. Manual aborts will not end the transaction with an active exception.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">pool</td><td>the pool in which the transaction will take place. </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">locks</td><td>locks to be taken for the duration of the transaction. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">tx</td><td>an std::function&lt;void ()&gt; which will perform operations within this transaction.</td></tr>
  </table>
  </dd>
</dl>
<dl class="exception"><dt>Exceptions</dt><dd>
  <table class="exception">
    <tr><td class="paramname"><a class="el" href="classnvml_1_1transaction__error.html" title="Custom transaction error class. ">transaction_error</a></td><td>on any error pertaining the execution of the transaction. </td></tr>
    <tr><td class="paramname"><a class="el" href="classnvml_1_1manual__tx__abort.html" title="Custom transaction error class. ">manual_tx_abort</a></td><td>on manual transaction abort. </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/tkapela/github/nvml/src/include/libpmemobj/<a class="el" href="transaction_8hpp_source.html">transaction.hpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>

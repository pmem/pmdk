# Run the Bandit scanner for finding vulnerabilities in the python code.
name: Bandit

on: [push, pull_request, workflow_dispatch]

env:
  # Set path to the pmreorder tool. At the moment pmreorder is the only
  # Python-based tool released in the PMDK.
  SCAN_DIR: src/tools/pmreorder

jobs:
  bandit:
    name: Bandit
    runs-on: ubuntu-latest
    steps:
      - name: Clone the git repo
        uses: actions/checkout@v3

      - name: Install Bandit
        run: sudo apt-get -y install bandit

      - name: Run Bandit
        run: bandit --version && bandit -r "$SCAN_DIR"
